<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
    />
    <meta name="theme-color" content="#CB1482" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />

    <title>WebRTC Text chat</title>
    <meta
      name="description"
      content="Using WebRTC for peer-to-peer text chat"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css"
      integrity="sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Merriweather+Sans&display=swap"
      rel="stylesheet"
    />
    <style>
      *,
      *:before,
      *:after {
        box-sizing: border-box;
      }

      * {
        font-family: "Merriweather Sans", sans-serif;
      }

      html,
      body {
        min-height: 100% !important;
        height: 100%;
      }

      body {
        background-color: #47a6d8;
        margin: 0;
        padding: 20px 0;
        display: flex;
        flex-direction: column;
        color: #121212;
        --border-radius-sm: 5px;
      }

      .main {
        flex-grow: 1;
        width: 600px;
        /* change svg buttons too*/
        background-color: #f5f5f5;
        height: 100vh;
        margin: 0 auto;
        padding: 10px;
        border-radius: 10px;
        display: flex;
        flex-direction: column;
      }

      .svg-btn {
        flex-grow: 0;
        padding: 0;
        aspect-ratio: 1;
        border-radius: var(--border-radius-sm);
        outline: none;
        cursor: pointer;
        transition: all 0.1s;
      }

      .header {
        flex-grow: 0;
      }

      .header h1 {
        text-align: center;
        margin-top: 0;
      }

      .header-state-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .disconnect-btn {
        --size: 40px;
        background-color: lch(47.37% 72.16 32.95);
        border: 1px solid lch(36.77% 72.16 32.95);
        width: var(--size);
      }
      .disconnect-btn:hover {
        background-color: lch(67.37% 72.16 32.95);
      }

      .messages-container {
        flex-grow: 1;
        height: 0;
        overflow-y: scroll;
        position: relative;
      }

      .has-more-messages-indicator {
        opacity: 0;
        position: relative;
        transition: opacity 0.2s;
      }
      .messages-container-has-more .has-more-messages-indicator {
        opacity: 1;
      }
      .has-more-messages-indicator:after {
        content: "";
        position: absolute;
        left: 0;
        top: 50%;
        width: 100%;
        height: 1px;
        border-radius: 50%;
        animation: pulse-animation 1s infinite;
      }
      @keyframes pulse-animation {
        0% {
          box-shadow: 0 0 0 0px rgba(179, 37, 37, 0.2);
        }
        100% {
          box-shadow: 0 0 0 30px rgba(179, 37, 37, 0);
        }
      }

      .messages {
        list-style: none;
        padding: 0;
        margin: 0;
      }

      .msg-container {
      }

      .msg-username {
        padding: 5px 10px;
        margin-right: 10px;
        border-radius: 5px;
        display: inline-block;
      }

      .msg-date {
        font-size: 0.85em;
        color: #5e5e5e;
      }

      .msg-text {
        display: block;
        line-height: 1.2em;
        line-height: 1.3em;
        margin-top: 6px;
        margin-bottom: 20px;
      }

      .msg-container:last-child .msg-text {
        margin-bottom: 10px;
      }

      .send-container {
        flex-grow: 0;
      }

      .send-form {
        display: flex;
        gap: 10px;
      }

      .send-input {
        flex-grow: 1;
        border-radius: var(--border-radius-sm);
        box-shadow: none;
        border: 1px solid #959595;
      }

      .send-btn {
        --size: 50px;
        background-color: lch(70% 79.27 139.61);
        border: 1px solid lch(45% 57.94 136.42);
        width: var(--size);
      }
      .send-btn:hover {
        background-color: lch(80% 70.01 141.82);
      }

      .send-btn svg {
        width: var(--size);
      }
    </style>
  </head>

  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>

    <main class="main">
      <div class="header">
        <h1>WebRTC Text chat</h1>
        <div class="header-state-row">
          <div>Users: <span id="user-count">1</span></div>
          <div class="has-more-messages-indicator">Scrolled!</div>
          <button class="svg-btn disconnect-btn">
            <svg
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M19.0599 5.99992L20.2999 4.75992C20.5899 4.46992 20.5899 3.98992 20.2999 3.69992C20.0099 3.40992 19.5299 3.40992 19.2399 3.69992L17.9999 4.93992L16.7599 3.69992C16.4699 3.40992 15.9899 3.40992 15.6999 3.69992C15.4099 3.98992 15.4099 4.46992 15.6999 4.75992L16.9399 5.99992L15.6999 7.23992C15.4099 7.52992 15.4099 8.00992 15.6999 8.29992C15.8499 8.44992 16.0399 8.51992 16.2299 8.51992C16.4199 8.51992 16.6099 8.44992 16.7599 8.29992L17.9999 7.05992L19.2399 8.29992C19.3899 8.44992 19.5799 8.51992 19.7699 8.51992C19.9599 8.51992 20.1499 8.44992 20.2999 8.29992C20.5899 8.00992 20.5899 7.52992 20.2999 7.23992L19.0599 5.99992Z"
                fill="#f5f5f5"
              />
              <path
                d="M11.79 14.21L8.52 17.48C8.16 17.16 7.81 16.83 7.47 16.49C6.44 15.45 5.51 14.36 4.68 13.22C3.86 12.08 3.2 10.94 2.72 9.81C2.24 8.67 2 7.58 2 6.54C2 5.86 2.12 5.21 2.36 4.61C2.6 4 2.98 3.44 3.51 2.94C4.15 2.31 4.85 2 5.59 2C5.87 2 6.15 2.06 6.4 2.18C6.66 2.3 6.89 2.48 7.07 2.74L9.39 6.01C9.57 6.26 9.7 6.49 9.79 6.71C9.88 6.92 9.93 7.13 9.93 7.32C9.93 7.56 9.86 7.8 9.72 8.03C9.59 8.26 9.4 8.5 9.16 8.74L8.4 9.53C8.29 9.64 8.24 9.77 8.24 9.93C8.24 10.01 8.25 10.08 8.27 10.16C8.3 10.24 8.33 10.3 8.35 10.36C8.53 10.69 8.84 11.12 9.28 11.64C9.73 12.16 10.21 12.69 10.73 13.22C11.09 13.57 11.44 13.91 11.79 14.21Z"
                fill="#f5f5f5"
              />
              <path
                d="M21.9696 18.33C21.9696 18.61 21.9196 18.9 21.8196 19.18C21.7896 19.26 21.7596 19.34 21.7196 19.42C21.5496 19.78 21.3296 20.12 21.0396 20.44C20.5496 20.98 20.0096 21.37 19.3996 21.62C19.3896 21.62 19.3796 21.63 19.3696 21.63C18.7796 21.87 18.1396 22 17.4496 22C16.4296 22 15.3396 21.76 14.1896 21.27C13.0396 20.78 11.8896 20.12 10.7496 19.29C10.3596 19 9.96961 18.71 9.59961 18.4L12.8696 15.13C13.1496 15.34 13.3996 15.5 13.6096 15.61C13.6596 15.63 13.7196 15.66 13.7896 15.69C13.8696 15.72 13.9496 15.73 14.0396 15.73C14.2096 15.73 14.3396 15.67 14.4496 15.56L15.2096 14.81C15.4596 14.56 15.6996 14.37 15.9296 14.25C16.1596 14.11 16.3896 14.04 16.6396 14.04C16.8296 14.04 17.0296 14.08 17.2496 14.17C17.4696 14.26 17.6996 14.39 17.9496 14.56L21.2596 16.91C21.5196 17.09 21.6996 17.3 21.8096 17.55C21.9096 17.8 21.9696 18.05 21.9696 18.33Z"
                fill="#f5f5f5"
              />
            </svg>
          </button>
        </div>
      </div>

      <div id="messages-container" class="messages-container">
        <ul id="messages" class="messages"></ul>
      </div>

      <div class="send-container">
        <form id="form" class="send-form" action="">
          <input id="input" class="send-input" autocomplete="off" />
          <button class="svg-btn send-btn">
            <svg
              viewBox="0 -0.5 25 25"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M18.455 9.8834L7.063 4.1434C6.76535 3.96928 6.40109 3.95274 6.08888 4.09916C5.77667 4.24558 5.55647 4.53621 5.5 4.8764C5.5039 4.98942 5.53114 5.10041 5.58 5.2024L7.749 10.4424C7.85786 10.7903 7.91711 11.1519 7.925 11.5164C7.91714 11.8809 7.85789 12.2425 7.749 12.5904L5.58 17.8304C5.53114 17.9324 5.5039 18.0434 5.5 18.1564C5.55687 18.4961 5.77703 18.7862 6.0889 18.9323C6.40078 19.0785 6.76456 19.062 7.062 18.8884L18.455 13.1484C19.0903 12.8533 19.4967 12.2164 19.4967 11.5159C19.4967 10.8154 19.0903 10.1785 18.455 9.8834V9.8834Z"
                fill="#f5f5f5"
              />
            </svg>
          </button>
        </form>
      </div>
    </main>

    <script src="//cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script type="module" src="index.js"></script>
  </body>
</html>
